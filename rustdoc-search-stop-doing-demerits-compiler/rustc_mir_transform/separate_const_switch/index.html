<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A pass that duplicates switch-terminated blocks into a new copy for each predecessor, provided the predecessor sets the value being switched over to a constant."><meta name="keywords" content="rust, rustlang, rust-lang, separate_const_switch"><title>rustc_mir_transform::separate_const_switch - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-0136d89ac73d270a.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../static.files/light-8fe2cf7ee64a76fb.css"><link rel="stylesheet" disabled href="../../static.files/dark-7aacebe982779e9a.css"><link rel="stylesheet" disabled href="../../static.files/ayu-29dcc614f7a7b461.css"><script id="default-settings" ></script><script src="../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../static.files/main-a211dbb005fb8161.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../rustc_mir_transform/index.html"><div class="logo-container"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../rustc_mir_transform/index.html"><div class="logo-container"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module separate_const_switch</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press â€˜Sâ€™ to search, â€˜?â€™ for more optionsâ€¦" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Module <a href="../index.html">rustc_mir_transform</a>::<wbr><a class="mod" href="#">separate_const_switch</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/rustc_mir_transform/separate_const_switch.rs.html#1-341">source</a> Â· <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A pass that duplicates switch-terminated blocks
into a new copy for each predecessor, provided
the predecessor sets the value being switched
over to a constant.</p>
<p>The purpose of this pass is to help constant
propagation passes to simplify the switch terminator
of the copied blocks into gotos when some predecessors
statically determine the output of switches.</p>
<div class="example-wrap"><pre class="language-text"><code>    x = 12 ---              ---&gt; something
              \            / 12
               --&gt; switch x
              /            \ otherwise
    x = y  ---              ---&gt; something else
</code></pre></div>
<p>becomes</p>
<div class="example-wrap"><pre class="language-text"><code>    x = 12 ---&gt; switch x ------&gt; something
                         \ / 12
                          X
                         / \ otherwise
    x = y  ---&gt; switch x ------&gt; something else
</code></pre></div>
<p>so it can hopefully later be turned by another pass into</p>
<div class="example-wrap"><pre class="language-text"><code>    x = 12 --------------------&gt; something
                           / 12
                          /
                         /   otherwise
    x = y  ---- switch x ------&gt; something else
</code></pre></div>
<p>This optimization is meant to cover simple cases
like <code>?</code> desugaring. For now, it thus focuses on
simplicity rather than completeness (it notably
sometimes duplicates abusively).</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left unstable module-item"><a class="struct" href="struct.SeparateConstSwitch.html" title="rustc_mir_transform::separate_const_switch::SeparateConstSwitch struct">SeparateConstSwitch</a></div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.find_determining_place.html" title="rustc_mir_transform::separate_const_switch::find_determining_place fn">find_determining_place</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="item-right docblock-short">Finds a unique place that entirely determines the value
of <code>switch_place</code>, if it exists. This is only a heuristic.
Ideally we would like to track multiple determining places
for some edge cases, but one is enough for a lot of situations.</div></div><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.is_likely_const.html" title="rustc_mir_transform::separate_const_switch::is_likely_const fn">is_likely_const</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="item-right docblock-short">This function describes a rough heuristic guessing
whether a place is last set with a const within the block.
Notably, it will be overly pessimistic in cases that are already
not handled by <code>separate_const_switch</code>.</div></div><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.separate_const_switch.html" title="rustc_mir_transform::separate_const_switch::separate_const_switch fn">separate_const_switch</a></div><div class="item-right docblock-short">Returns the amount of blocks that were duplicated</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="rustc_mir_transform" data-themes="" data-resource-suffix="" data-rustdoc-version="1.68.0-dev" data-search-js="search-2dc3ecf90030732f.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>