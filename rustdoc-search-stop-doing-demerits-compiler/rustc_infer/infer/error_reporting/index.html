<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Error Reporting Code for the inference engine"><meta name="keywords" content="rust, rustlang, rust-lang, error_reporting"><title>rustc_infer::infer::error_reporting - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-0136d89ac73d270a.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../../static.files/light-8fe2cf7ee64a76fb.css"><link rel="stylesheet" disabled href="../../../static.files/dark-7aacebe982779e9a.css"><link rel="stylesheet" disabled href="../../../static.files/ayu-29dcc614f7a7b461.css"><script id="default-settings" ></script><script src="../../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../../static.files/main-a211dbb005fb8161.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../rustc_infer/index.html"><div class="logo-container"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../../rustc_infer/index.html"><div class="logo-container"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module error_reporting</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Module <a href="../../index.html">rustc_infer</a>::<wbr><a href="../index.html">infer</a>::<wbr><a class="mod" href="#">error_reporting</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/rustc_infer/infer/error_reporting/mod.rs.html#2-2807">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Error Reporting Code for the inference engine</p>
<p>Because of the way inference, and in particular region inference,
works, it often happens that errors are not detected until far after
the relevant line of code has been type-checked. Therefore, there is
an elaborate system to track why a particular constraint in the
inference graph arose so that we can explain to the user what gave
rise to a particular error.</p>
<p>The system is based around a set of “origin” types. An “origin” is the
reason that a constraint or inference variable arose. There are
different “origin” enums for different kinds of constraints/variables
(e.g., <code>TypeOrigin</code>, <code>RegionVariableOrigin</code>). An origin always has
a span, but also more information so that we can generate a meaningful
error message.</p>
<p>Having a catalog of all the different reasons an error can arise is
also useful for other reasons, like cross-referencing FAQs etc, though
we are not really taking advantage of this yet.</p>
<h2 id="region-inference"><a href="#region-inference">Region Inference</a></h2>
<p>Region inference is particularly tricky because it always succeeds “in
the moment” and simply registers a constraint. Then, at the end, we
can compute the full graph and report errors, so we need to be able to
store and later report what gave rise to the conflicting constraints.</p>
<h2 id="subtype-trace"><a href="#subtype-trace">Subtype Trace</a></h2>
<p>Determining whether <code>T1 &lt;: T2</code> often involves a number of subtypes and
subconstraints along the way. A “TypeTrace” is an extended version
of an origin that traces the types and other values that were being
compared. It is not necessarily comprehensive (in fact, at the time of
this writing it only tracks the root values being compared) but I’d
like to extend it to include significant “waypoints”. For example, if
you are comparing <code>(T1, T2) &lt;: (T3, T4)</code>, and the problem is that <code>T2 &lt;: T4</code> fails, I’d like the trace to include enough information to say
“in the 2nd element of the tuple”. Similarly, failures when comparing
arguments or return types in fn types should be able to cite the
specific position, etc.</p>
<h2 id="reality-vs-plan"><a href="#reality-vs-plan">Reality vs plan</a></h2>
<p>Of course, there is still a LOT of code in typeck that has yet to be
ported to this system, and which relies on string concatenation at the
time of error detection.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left unstable module-item"><a class="mod" href="need_type_info/index.html" title="rustc_infer::infer::error_reporting::need_type_info mod">need_type_info</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></div><div class="item-row"><div class="item-left unstable module-item"><a class="mod" href="nice_region_error/index.html" title="rustc_infer::infer::error_reporting::nice_region_error mod">nice_region_error</a></div></div><div class="item-row"><div class="item-left unstable module-item"><a class="mod" href="note/index.html" title="rustc_infer::infer::error_reporting::note mod">note</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></div><div class="item-row"><div class="item-left unstable module-item"><a class="mod" href="suggest/index.html" title="rustc_infer::infer::error_reporting::suggest mod">suggest</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left unstable module-item"><a class="struct" href="struct.ObligationCauseAsDiagArg.html" title="rustc_infer::infer::error_reporting::ObligationCauseAsDiagArg struct">ObligationCauseAsDiagArg</a></div><div class="item-right docblock-short">Newtype to allow implementing IntoDiagnosticArg</div></div><div class="item-row"><div class="item-left unstable module-item"><a class="struct" href="struct.SameTypeModuloInfer.html" title="rustc_infer::infer::error_reporting::SameTypeModuloInfer struct">SameTypeModuloInfer</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></div><div class="item-row"><div class="item-left unstable module-item"><a class="struct" href="struct.TypeErrCtxt.html" title="rustc_infer::infer::error_reporting::TypeErrCtxt struct">TypeErrCtxt</a></div><div class="item-right docblock-short">A helper for building type related errors. The <code>typeck_results</code>
field is only populated during an in-progress typeck.
Get an instance by calling <code>InferCtxt::err</code> or <code>FnCtxt::infer_err</code>.</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left unstable module-item"><a class="enum" href="enum.FailureCode.html" title="rustc_infer::infer::error_reporting::FailureCode enum">FailureCode</a></div></div><div class="item-row"><div class="item-left unstable module-item"><a class="enum" href="enum.TyCategory.html" title="rustc_infer::infer::error_reporting::TyCategory enum">TyCategory</a></div><div class="item-right docblock-short">This is a bare signal of what kind of type we’re dealing with. <code>ty::TyKind</code> tracks
extra information about each type, but we only care about the category.</div></div><div class="item-row"><div class="item-left unstable module-item"><a class="enum" href="enum.TypeAnnotationNeeded.html" title="rustc_infer::infer::error_reporting::TypeAnnotationNeeded enum">TypeAnnotationNeeded</a></div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left unstable module-item"><a class="trait" href="trait.ObligationCauseExt.html" title="rustc_infer::infer::error_reporting::ObligationCauseExt trait">ObligationCauseExt</a></div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.emit_msg_span.html" title="rustc_infer::infer::error_reporting::emit_msg_span fn">emit_msg_span</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></div><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.explain_free_region.html" title="rustc_infer::infer::error_reporting::explain_free_region fn">explain_free_region</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></div><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.label_msg_span.html" title="rustc_infer::infer::error_reporting::label_msg_span fn">label_msg_span</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></div><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.msg_span_from_early_bound_and_free_regions.html" title="rustc_infer::infer::error_reporting::msg_span_from_early_bound_and_free_regions fn">msg_span_from_early_bound_and_free_regions</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></div><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.msg_span_from_free_region.html" title="rustc_infer::infer::error_reporting::msg_span_from_free_region fn">msg_span_from_free_region</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></div><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.note_and_explain_region.html" title="rustc_infer::infer::error_reporting::note_and_explain_region fn">note_and_explain_region</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></div><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.unexpected_hidden_region_diagnostic.html" title="rustc_infer::infer::error_reporting::unexpected_hidden_region_diagnostic fn">unexpected_hidden_region_diagnostic</a></div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="rustc_infer" data-themes="" data-resource-suffix="" data-rustdoc-version="1.68.0-dev" data-search-js="search-2dc3ecf90030732f.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>