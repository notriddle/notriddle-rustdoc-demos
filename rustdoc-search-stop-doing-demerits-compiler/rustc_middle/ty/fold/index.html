<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A folding traversal mechanism for complex data structures that contain type information."><meta name="keywords" content="rust, rustlang, rust-lang, fold"><title>rustc_middle::ty::fold - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-0136d89ac73d270a.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../../static.files/light-8fe2cf7ee64a76fb.css"><link rel="stylesheet" disabled href="../../../static.files/dark-7aacebe982779e9a.css"><link rel="stylesheet" disabled href="../../../static.files/ayu-29dcc614f7a7b461.css"><script id="default-settings" ></script><script src="../../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../../static.files/main-a211dbb005fb8161.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../rustc_middle/index.html"><div class="logo-container"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../../rustc_middle/index.html"><div class="logo-container"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module fold</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‚ÄòS‚Äô to search, ‚Äò?‚Äô for more options‚Ä¶" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Module <a href="../../index.html">rustc_middle</a>::<wbr><a href="../index.html">ty</a>::<wbr><a class="mod" href="#">fold</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/rustc_middle/ty/fold.rs.html#1-733">source</a> ¬∑ <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A folding traversal mechanism for complex data structures that contain type
information.</p>
<p>This is a modifying traversal. It consumes the data structure, producing a
(possibly) modified version of it. Both fallible and infallible versions are
available. The name is potentially confusing, because this traversal is more
like <code>Iterator::map</code> than <code>Iterator::fold</code>.</p>
<p>This traversal has limited flexibility. Only a small number of ‚Äútypes of
interest‚Äù within the complex data structures can receive custom
modification. These are the ones containing the most important type-related
information, such as <code>Ty</code>, <code>Predicate</code>, <code>Region</code>, and <code>Const</code>.</p>
<p>There are three groups of traits involved in each traversal.</p>
<ul>
<li><code>TypeFoldable</code>. This is implemented once for many types, including:
<ul>
<li>Types of interest, for which the methods delegate to the folder.</li>
<li>All other types, including generic containers like <code>Vec</code> and <code>Option</code>.
It defines a ‚Äúskeleton‚Äù of how they should be folded.</li>
</ul>
</li>
<li><code>TypeSuperFoldable</code>. This is implemented only for each type of interest,
and defines the folding ‚Äúskeleton‚Äù for these types.</li>
<li><code>TypeFolder</code>/`FallibleTypeFolder. One of these is implemented for each
folder. This defines how types of interest are folded.</li>
</ul>
<p>This means each fold is a mixture of (a) generic folding operations, and (b)
custom fold operations that are specific to the folder.</p>
<ul>
<li>The <code>TypeFoldable</code> impls handle most of the traversal, and call into
<code>TypeFolder</code>/<code>FallibleTypeFolder</code> when they encounter a type of interest.</li>
<li>A <code>TypeFolder</code>/<code>FallibleTypeFolder</code> may call into another <code>TypeFoldable</code>
impl, because some of the types of interest are recursive and can contain
other types of interest.</li>
<li>A <code>TypeFolder</code>/<code>FallibleTypeFolder</code> may also call into a <code>TypeSuperFoldable</code>
impl, because each folder might provide custom handling only for some types
of interest, or only for some variants of each type of interest, and then
use default traversal for the remaining cases.</li>
</ul>
<p>For example, if you have <code>struct S(Ty, U)</code> where <code>S: TypeFoldable</code> and <code>U: TypeFoldable</code>, and an instance <code>s = S(ty, u)</code>, it would be folded like so:</p>
<div class="example-wrap"><pre class="language-text"><code>s.fold_with(folder) calls
- ty.fold_with(folder) calls
  - folder.fold_ty(ty) may call
    - ty.super_fold_with(folder)
- u.fold_with(folder)
</code></pre></div></div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left unstable module-item"><a class="struct" href="struct.BottomUpFolder.html" title="rustc_middle::ty::fold::BottomUpFolder struct">BottomUpFolder</a></div></div><div class="item-row"><div class="item-left unstable module-item"><a class="struct" href="struct.BoundVarReplacer.html" title="rustc_middle::ty::fold::BoundVarReplacer struct">BoundVarReplacer</a><span title="Restricted Visibility">&nbsp;üîí</span> </div><div class="item-right docblock-short">Replaces the escaping bound vars (late bound regions or bound types) in a type.</div></div><div class="item-row"><div class="item-left unstable module-item"><a class="struct" href="struct.FnMutDelegate.html" title="rustc_middle::ty::fold::FnMutDelegate struct">FnMutDelegate</a></div></div><div class="item-row"><div class="item-left unstable module-item"><a class="struct" href="struct.RegionFolder.html" title="rustc_middle::ty::fold::RegionFolder struct">RegionFolder</a></div><div class="item-right docblock-short">Folds over the substructure of a type, visiting its component
types and all regions that occur <em>free</em> within it.</div></div><div class="item-row"><div class="item-left unstable module-item"><a class="struct" href="struct.Shifter.html" title="rustc_middle::ty::fold::Shifter struct">Shifter</a><span title="Restricted Visibility">&nbsp;üîí</span> </div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left unstable module-item"><a class="trait" href="trait.BoundVarReplacerDelegate.html" title="rustc_middle::ty::fold::BoundVarReplacerDelegate trait">BoundVarReplacerDelegate</a></div></div><div class="item-row"><div class="item-left unstable module-item"><a class="trait" href="trait.FallibleTypeFolder.html" title="rustc_middle::ty::fold::FallibleTypeFolder trait">FallibleTypeFolder</a></div><div class="item-right docblock-short">This trait is implemented for every folding traversal. There is a fold
method defined for every type of interest. Each such method has a default
that does an ‚Äúidentity‚Äù fold.</div></div><div class="item-row"><div class="item-left unstable module-item"><a class="trait" href="trait.TypeFoldable.html" title="rustc_middle::ty::fold::TypeFoldable trait">TypeFoldable</a></div><div class="item-right docblock-short">This trait is implemented for every type that can be folded,
providing the skeleton of the traversal.</div></div><div class="item-row"><div class="item-left unstable module-item"><a class="trait" href="trait.TypeFolder.html" title="rustc_middle::ty::fold::TypeFolder trait">TypeFolder</a></div><div class="item-right docblock-short">This trait is implemented for every infallible folding traversal. There is
a fold method defined for every type of interest. Each such method has a
default that does an ‚Äúidentity‚Äù fold. Implementations of these methods
often fall back to a <code>super_fold_with</code> method if the primary argument
doesn‚Äôt satisfy a particular condition.</div></div><div class="item-row"><div class="item-left unstable module-item"><a class="trait" href="trait.TypeSuperFoldable.html" title="rustc_middle::ty::fold::TypeSuperFoldable trait">TypeSuperFoldable</a></div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.shift_region.html" title="rustc_middle::ty::fold::shift_region fn">shift_region</a></div></div><div class="item-row"><div class="item-left unstable module-item"><a class="fn" href="fn.shift_vars.html" title="rustc_middle::ty::fold::shift_vars fn">shift_vars</a></div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="rustc_middle" data-themes="" data-resource-suffix="" data-rustdoc-version="1.68.0-dev" data-search-js="search-2dc3ecf90030732f.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>